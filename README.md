# 金小村数据库表创建和数据导入

本项目用于将Excel表格数据导入到MySQL数据库中。

## 文件说明

### Excel文件
- `客户原始兑付明细2.xlsx` - 客户兑付明细数据
- `客户流向2.xlsx` - 客户流向数据
- `活动方案.xlsx` - 活动方案数据
- `输出结果.xlsx` - 输出结果数据

### 脚本文件
- `analyze_excel.py` - 分析Excel文件结构
- `create_tables.sql` - 数据库表创建SQL语句
- `import_data.py` - 数据导入脚本

## 使用步骤

### 1. 环境准备

确保已安装以下Python包：
```bash
pip install pandas openpyxl mysql-connector-python
```

### 2. 数据库配置

在运行脚本之前，请确保：
- MySQL服务已启动
- 修改 `import_data.py` 中的数据库连接信息：
  - host: 数据库主机地址
  - user: 数据库用户名
  - password: 数据库密码

### 3. 分析Excel文件结构

运行分析脚本查看Excel文件结构：
```bash
python analyze_excel.py
```

### 4. 创建数据库表

手动执行SQL文件或使用导入脚本：
```bash
python import_data.py
```

## 数据库表结构

### 1. customer_redemption_details (客户原始兑付明细表)
- 包含客户兑付相关的详细信息
- 主要字段：结算金额、业务日期、客户编码、商品名称等

### 2. customer_flow (客户流向表)
- 记录客户间的商品流向
- 主要字段：进货日期、流入方、流出方、物料信息等

### 3. activity_plan (活动方案表)
- 存储活动方案信息
- 主要字段：活动时间、产品名称、活动政策等

### 4. output_results (输出结果表)
- 存储处理后的结果数据
- 主要字段：进货日期、销售信息、活动政策等

## 注意事项

1. 确保Excel文件编码为UTF-8
2. 数据库连接信息需要根据实际情况修改
3. 如果表已存在，需要先删除或使用不同的表名
4. 活动方案表的结构比较特殊，可能需要手动调整

## 故障排除

### 常见问题

1. **数据库连接失败**
   - 检查MySQL服务是否启动
   - 确认用户名和密码是否正确
   - 检查数据库是否存在

2. **编码问题**
   - 确保Excel文件使用UTF-8编码
   - 检查数据库字符集设置

3. **数据类型不匹配**
   - 检查Excel文件中的数据类型
   - 可能需要手动调整SQL表结构

## 联系信息

如有问题，请联系开发团队。 