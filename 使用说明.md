# 金小村数据库表创建和数据导入使用说明

## 概述

本项目用于将4个Excel表格的数据导入到MySQL数据库中，创建对应的数据库表结构。

## 📋 已创建的文件

###  核心脚本文件
1. **`analyze_excel.py`** - Excel文件结构分析脚本
2. **`create_tables_simple.sql`** - 简化的数据库表创建SQL
3. **`simple_import.py`** - 简化的数据导入脚本

### 📚 文档文件
4. **`README.md`** - 项目说明文档
5. **`使用说明.md`** - 详细的使用说明

## 🗄️ 数据库表结构

基于您的4个Excel文件，我创建了以下4张表：

### 1. **customer_redemption_details** (客户原始兑付明细表)
- 463行数据，18列
- 主要字段：结算金额、业务日期、客户编码、商品名称等

### 2. **customer_flow** (客户流向表)
- 700行数据，13列
- 主要字段：进货日期、流入方、流出方、物料信息等

### 3. **activity_plan** (活动方案表)
- 31行数据，9列
- 主要字段：活动时间、产品名称、活动政策等

### 4. **output_results** (输出结果表)
- 20行数据，19列
- 主要字段：进货日期、销售信息、活动政策等

##  使用步骤

### 1. 环境准备
```bash
pip install pandas openpyxl mysql-connector-python
```

### 2. 创建数据库表
```bash
mysql -u root -p < create_tables_simple.sql
```

### 3. 导入数据
```bash
python simple_import.py
```

## ⚙️ 配置说明

在使用前，请确保：
- MySQL服务已启动
- 修改 `simple_import.py` 中的数据库连接信息（用户名、密码等）
- 确保Excel文件编码为UTF-8

##  数据验证

导入完成后，可以使用以下SQL验证数据：
```sql
SELECT 'customer_redemption_details' as table_name, COUNT(*) as count FROM customer_redemption_details
UNION ALL
SELECT 'customer_flow', COUNT(*) FROM customer_flow
UNION ALL
SELECT 'activity_plan', COUNT(*) FROM activity_plan
UNION ALL
SELECT 'output_results', COUNT(*) FROM output_results;
```

所有文件都已准备就绪，您可以直接使用这些脚本来创建数据库表并导入Excel数据！ 