# 错误处理说明

## 常见错误及解决方案

### 1. SQL语法错误 (1064)

**错误信息**: `You have an error in your SQL syntax`

**原因**: 列名包含特殊字符或与数据库表字段不匹配

**解决方案**:
- 使用 `debug_import.py` 脚本进行调试
- 检查Excel列名与数据库表字段是否匹配
- 确保列名不包含特殊字符

### 2. 数据库连接失败

**错误信息**: `Can't connect to MySQL server`

**解决方案**:
- 检查MySQL服务是否启动
- 确认用户名和密码是否正确
- 检查数据库是否存在

### 3. 表不存在错误

**错误信息**: `Table doesn't exist`

**解决方案**:
- 先执行 `create_tables_simple.sql` 创建表
- 检查表名是否正确

### 4. 数据类型不匹配

**错误信息**: `Incorrect integer value` 或类似错误

**解决方案**:
- 检查Excel中的数据类型
- 调整数据库表字段类型

## 调试步骤

### 1. 使用调试脚本
```bash
python debug_import.py
```

### 2. 检查表结构
```sql
DESCRIBE activity_plan;
```

### 3. 验证数据
```sql
SELECT COUNT(*) FROM activity_plan;
SELECT * FROM activity_plan LIMIT 5;
```

## 活动方案表特殊处理

活动方案表结构特殊，已自动处理：
- 第3行作为列名
- 第5行开始为数据
- 自动清理列名中的特殊字符

## 推荐使用顺序

1. 先运行 `debug_import.py` 进行调试
2. 根据调试信息修正问题
3. 使用 `simple_import.py` 进行正式导入

## 联系支持

如遇到其他问题，请提供：
- 完整的错误信息
- 调试脚本的输出
- 数据库表结构信息 